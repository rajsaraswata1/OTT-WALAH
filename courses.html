<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Courses — OTT Wallah</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./style.css">

  <style>
    .page-hero{
      padding:60px 20px 20px;
      text-align:center;
    }
    .page-hero h1{
      font-size:38px;
      font-weight:900;
    }
    .page-hero p{
      opacity:.75;
      max-width:700px;
      margin:10px auto 0;
    }
  </style>
</head>

<body>

<header class="header">
  <div class="container header-inner">
    <div class="brand">
      <div class="brand-badge">OW</div>
      <div>
        <div style="font-size:18px;font-weight:900;">OTT WALLAH</div>
        <div class="small">Online Learning</div>
      </div>
    </div>

    <div class="header-actions">
      <a class="btn" href="index.html">Home</a>
      <a class="btn" href="cart.html">Cart</a>
      <a class="btn" href="login.html">Login</a>
    </div>
  </div>
</header>

<section class="page-hero">
  <h1>Online Courses</h1>
  <p>Build skills with Coursera, Udemy, LinkedIn Learning, Skillshare and many more platforms.</p>
</section>

<div class="container search-row">
  <input id="q" class="input" placeholder="Search course platform...">
  <select id="sort" class="filter">
    <option value="rel">Featured</option>
    <option value="lh">Low → High</option>
    <option value="hl">High → Low</option>
    <option value="az">A → Z</option>
  </select>
</div>

<section class="container section">
  <div id="grid" class="grid"></div>
</section>

<script src="./data.js"></script>
<script>
 const grid=document.getElementById("grid"), q=document.getElementById("q"), sort=document.getElementById("sort");

 function cardHTML(i){
   return `
     <div class="card">
       <span class="ribbon">Courses</span>
       <img class="logo" src="${i.logo}">
       <div class="title">${i.name}</div>
       <div class="small">${i.tags.join(" • ")}</div>
       <div class="price">₹${i.price}${i.billing}</div>
       <div class="card-actions">
         <a class="link" href="details.html?id=${i.id}">View details</a>
         <button class="btn" onclick="addToCart('${i.id}')">Add to cart</button>
       </div>
     </div>`;
 }

async function addToCart(id) {

  let user = await fetch("/user").then(r => {
    if (r.status === 401) return null;
    return r.json();
  });

  if (!user) {
    window.location.href = "login.html";
    return;
  }

  let cart = JSON.parse(localStorage.getItem("cart") || "[]");
  if (!cart.find(i => i.id === id)) cart.push({ id, qty: 1 });
  localStorage.setItem("cart", JSON.stringify(cart));

  alert("Added to cart ✅");
}


 function filter(){
   let list=window.CATALOG.filter(i=>i.category=="courses");
   let t=q.value.toLowerCase();
   list=list.filter(i=>i.name.toLowerCase().includes(t));

   switch(sort.value){
     case "lh": list.sort((a,b)=>a.price-b.price); break;
     case "hl": list.sort((a,b)=>b.price-a.price); break;
     case "az": list.sort((a,b)=>a.name.localeCompare(b.name)); break;
   }

   grid.innerHTML=list.map(cardHTML).join("");
 }

 q.addEventListener("input", filter);
 sort.addEventListener("change", filter);

 filter();
</script>

</body>
</html>

